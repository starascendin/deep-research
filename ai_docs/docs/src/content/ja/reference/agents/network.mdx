---
title: "リファレンス: Agent.network()（実験的） | Agents | Mastra ドキュメント"
description: "Mastra のエージェントにおける `Agent.network()` メソッドのドキュメント。マルチエージェントの協調とルーティングを可能にします。"
---

import { NetworkCallout } from "@/components/network-callout.tsx"


# Agent.network()

<NetworkCallout />

`.network()` メソッドは、複数のエージェント間の協調やルーティングを可能にします。このメソッドは、メッセージと任意の実行オプションを受け取ります。

## 使用例

```typescript copy
import { Agent } from '@mastra/core/agent';
import { openai } from '@ai-sdk/openai';
import { agent1, agent2 } from './agents';
import { workflow1 } from './workflows';
import { tool1, tool2 } from './tools';

const agent = new Agent({
  name: 'network-agent',
  instructions: 'You are a network agent that can help users with a variety of tasks.',
  model: openai('gpt-4o'),
  agents: {
    agent1,
    agent2,
  },
  workflows: {
    workflow1,
  },
  tools: {
    tool1,
    tool2,
  },
})

await agent.network(`
  東京の天気を教えて。
  その天気に合わせて、できるアクティビティを計画して。
`);
```

## パラメータ

<PropertiesTable
  content={[
    {
      name: "messages",
      type: "string | string[] | CoreMessage[] | AiMessageType[] | UIMessageWithMetadata[]",
      description: "エージェントへ送信するメッセージ。単一の文字列、文字列の配列、または構造化メッセージオブジェクトを指定できます。",
    },
    {
      name: "options",
      type: "MultiPrimitiveExecutionOptions",
      isOptional: true,
      description: "ネットワーク処理に関する任意の設定。",
    },
  ]}
/>

### 設定

<PropertiesTable
  content={[
  {
    name: "maxSteps",
    type: "number",
    isOptional: true,
    description: "実行時に処理する最大ステップ数。",
  },
  {
    name: "memory",
    type: "object",
    isOptional: true,
    description: "メモリの設定。メモリ管理にはこの方法を推奨します。",
    properties: [
      {
        parameters: [{
            name: "thread",
            type: "string | { id: string; metadata?: Record<string, any>, title?: string }",
            isOptional: false,
            description: "会話スレッド。文字列のID、または `id` と任意の `metadata` を持つオブジェクトとして指定します。"
        }]
      },
      {
        parameters: [{
            name: "resource",
            type: "string",
            isOptional: false,
            description: "スレッドに関連付けられたユーザーまたはリソースの識別子。",
        }]
      },
      {
        parameters: [{
            name: "options",
            type: "MemoryConfig",
            isOptional: true,
            description: "メッセージ履歴やセマンティックリコールなど、メモリ動作の設定。",
        }]
      }
    ]
  },
  {
    name: "tracingContext",
    type: "TracingContext",
    isOptional: true,
    description: "スパン階層とメタデータ用のAIトレーシングコンテキスト。",
  },
  {
    name: "telemetry",
    type: "TelemetrySettings",
    isOptional: true,
    description:
      "ストリーミング中のテレメトリ収集の設定。",
    properties: [
      {
        parameters: [{
          name: "isEnabled",
          type: "boolean",
          isOptional: true,
          description: "テレメトリを有効または無効にします。実験段階ではデフォルトで無効です。",
        }]
      },
      {
        parameters: [{
          name: "recordInputs",
          type: "boolean",
          isOptional: true,
          description: "入力の記録を有効または無効にします。デフォルトで有効です。機密情報の記録を避けるため、入力記録を無効にすることもできます。",
        }]
      },
      {
        parameters: [{
          name: "recordOutputs",
          type: "boolean",
          isOptional: true,
          description: "出力の記録を有効または無効にします。デフォルトで有効です。機密情報の記録を避けるため、出力記録を無効にすることもできます。",
        }]
      },
      {
        parameters: [{
          name: "functionId",
          type: "string",
          isOptional: true,
          description: "この関数の識別子。テレメトリデータを関数単位でグループ化するために使用します。",
        }]
      }
    ]
  },
  {
    name: "modelSettings",
    type: "CallSettings",
    isOptional: true,
    description:
      "temperature、maxTokens、topP などのモデル固有の設定。これらは基盤の言語モデルに渡されます。",
    properties: [
      {
        parameters: [{
          name: "temperature",
          type: "number",
          isOptional: true,
          description: "モデル出力のランダム性を制御します。値が高い（例: 0.8）ほど出力はランダムになり、値が低い（例: 0.2）ほど焦点が定まり決定的になります。",
        }]
      },
      {
        parameters: [{
          name: "maxRetries",
          type: "number",
          isOptional: true,
          description: "失敗したリクエストの最大再試行回数。",
        }]
      },
      {
        parameters: [{
          name: "topP",
          type: "number",
          isOptional: true,
          description: "核サンプリング。0〜1 の数値です。temperature と topP はどちらか一方の設定を推奨します。",
        }]
      },
      {
        parameters: [{
          name: "topK",
          type: "number",
          isOptional: true,
          description: "以降の各トークンで、上位 K 個の選択肢からのみサンプリングします。確率の低い「ロングテール」の応答を除外するために使用します。",
        }]
      },
      {
        parameters: [{
          name: "presencePenalty",
          type: "number",
          isOptional: true,
          description: "presence penalty の設定。プロンプトに既に含まれる情報をモデルが繰り返す傾向に影響します。-1（繰り返しを増やす）から 1（最大のペナルティ、繰り返しを減らす）までの数値。",
        }]
      },
      {
        parameters: [{
          name: "frequencyPenalty",
          type: "number",
          isOptional: true,
          description: "frequency penalty の設定。同じ語やフレーズを繰り返し使用する傾向に影響します。-1（繰り返しを増やす）から 1（最大のペナルティ、繰り返しを減らす）までの数値。",
        }]
      },
      {
        parameters: [{
          name: "stopSequences",
          type: "string[]",
          isOptional: true,
          description: "停止シーケンス。設定すると、いずれかの停止シーケンスが生成された時点でモデルはテキスト生成を停止します。"
        }]
      },
    ]
  },
  {
    name: "runId",
    type: "string",
    isOptional: true,
    description: "この生成ランの一意のID。追跡やデバッグに役立ちます。",
  },
  {
    name: "runtimeContext",
    type: "RuntimeContext",
    isOptional: true,
    description: "依存性の注入やコンテキスト情報のためのランタイムコンテキスト。",
  },
]}
/>

## 返り値

<PropertiesTable
  content={[
    {
      name: "stream",
      type: "MastraAgentNetworkStream<NetworkChunkType>",
      description: "ReadableStream<NetworkChunkType> を拡張し、ネットワーク固有の追加プロパティを備えたカスタムストリーム",
    },
    {
      name: "status",
      type: "Promise<RunStatus>",
      description: "現在のワークフロー実行ステータスを解決する Promise",
    },
    {
      name: "result",
      type: "Promise<WorkflowResult<TState, TOutput, TSteps>>",
      description: "最終的なワークフロー結果を解決する Promise",
    },
    {
      name: "usage",
      type: "Promise<{ promptTokens: number; completionTokens: number; totalTokens: number }>",
      description: "トークン使用状況の統計情報を解決する Promise",
    },
  ]}
/>