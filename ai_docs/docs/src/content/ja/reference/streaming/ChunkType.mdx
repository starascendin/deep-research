---
title: "リファレンス: ChunkType（実験的） | Agents | Mastra ドキュメント"
description: "Mastra のストリーミングレスポンスで使用される ChunkType 型に関するドキュメント。可能なすべてのチャンクタイプとそのペイロードを定義します。"
---

import { Callout } from "nextra/components";
import { PropertiesTable } from "@/components/properties-table";


# ChunkType（実験的）

<Callout type="important">
  <strong className="block">実験的なAPI：</strong>この型は実験的な `.streamVNext()` メソッドの一部です。フィードバックに基づいて機能を洗練していくに伴い、APIは変更される可能性があります。
</Callout>

`ChunkType` 型は、エージェントのストリーミング応答中に出力されるチャンクの mastra 形式を定義します。

## 基本プロパティ

すべてのチャンクには次の基本プロパティが含まれます:

<PropertiesTable
  content={[
    {
      name: "type",
      type: "string",
      description: "チャンクの種類を示す識別子"
    },
    {
      name: "runId",
      type: "string",
      description: "この実行の一意な識別子"
    },
    {
      name: "from",
      type: "ChunkFrom",
      description: "チャンクの出所",
      properties: [{
        type: "enum",
        parameters: [
          { name: "AGENT", type: "'AGENT'", description: "エージェントの実行によるチャンク" },
          { name: "USER", type: "'USER'", description: "ユーザー入力によるチャンク" },
          { name: "SYSTEM", type: "'SYSTEM'", description: "システム処理によるチャンク" },
          { name: "WORKFLOW", type: "'WORKFLOW'", description: "ワークフローの実行によるチャンク" }
        ]
      }]
    }
  ]}
/>

## テキストチャンク

### text-start

テキスト生成の開始を通知します。

<PropertiesTable
  content={[
    {
      name: "type",
      type: '"text-start"',
      description: "チャンク種別識別子"
    },
    {
      name: "payload",
      type: "TextStartPayload",
      description: "テキスト開始に関する情報",
      properties: [{
        type: "TextStartPayload",
        parameters: [
          { name: "id", type: "string", description: "このテキスト生成の一意の識別子" },
          { name: "providerMetadata", type: "SharedV2ProviderMetadata", isOptional: true, description: "プロバイダー固有のメタデータ" }
        ]
      }]
    }
  ]}
/>

### text-delta

生成中に出力される増分テキスト。

<PropertiesTable
  content={[
    {
      name: "type",
      type: '"text-delta"',
      description: "チャンク種別の識別子"
    },
    {
      name: "payload",
      type: "TextDeltaPayload",
      description: "増分テキスト",
      properties: [{
        type: "TextDeltaPayload",
        parameters: [
          { name: "id", type: "string", description: "このテキスト生成の一意の識別子" },
          { name: "text", type: "string", description: "増分テキスト" },
          { name: "providerMetadata", type: "SharedV2ProviderMetadata", isOptional: true, description: "プロバイダー固有のメタデータ" }
        ]
      }]
    }
  ]}
/>

### text-end

テキスト生成の終了を示します。

<PropertiesTable
  content={[
    {
      name: "type",
      type: '"text-end"',
      description: "チャンクの種類を示す識別子"
    },
    {
      name: "payload",
      type: "TextEndPayload",
      description: "テキスト終了に関する情報",
      properties: [{
        type: "TextEndPayload",
        parameters: [
          { name: "id", type: "string", description: "このテキスト生成に対する一意の識別子" },
          { name: "providerMetadata", type: "SharedV2ProviderMetadata", isOptional: true, description: "プロバイダー固有のメタデータ" }
        ]
      }]
    }
  ]}
/>

## 推論のチャンク

### reasoning-start

推論生成の開始を示します（推論対応モデル向け）。

<PropertiesTable
  content={[
    {
      name: "type",
      type: '"reasoning-start"',
      description: "チャンク種別の識別子"
    },
    {
      name: "payload",
      type: "ReasoningStartPayload",
      description: "推論開始に関する情報",
      properties: [{
        type: "ReasoningStartPayload",
        parameters: [
          { name: "id", type: "string", description: "この推論生成の一意の識別子" },
          { name: "signature", type: "string", isOptional: true, description: "利用可能な場合の推論署名" },
          { name: "providerMetadata", type: "SharedV2ProviderMetadata", isOptional: true, description: "プロバイダー固有のメタデータ" }
        ]
      }]
    }
  ]}
/>

### reasoning-delta

生成中に逐次出力される推論テキスト。

<PropertiesTable
  content={[
    {
      name: "type",
      type: '"reasoning-delta"',
      description: "チャンク種別の識別子"
    },
    {
      name: "payload",
      type: "ReasoningDeltaPayload",
      description: "逐次的な推論コンテンツ",
      properties: [{
        type: "ReasoningDeltaPayload",
        parameters: [
          { name: "id", type: "string", description: "この推論生成の一意の識別子" },
          { name: "text", type: "string", description: "逐次的な推論テキスト" },
          { name: "providerMetadata", type: "SharedV2ProviderMetadata", isOptional: true, description: "プロバイダー固有のメタデータ" }
        ]
      }]
    }
  ]}
/>

### reasoning-end

推論生成の終了を通知します。

<PropertiesTable
  content={[
    {
      name: "type",
      type: '"reasoning-end"',
      description: "チャンク種別識別子"
    },
    {
      name: "payload",
      type: "ReasoningEndPayload",
      description: "推論終了に関する情報",
      properties: [{
        type: "ReasoningEndPayload",
        parameters: [
          { name: "id", type: "string", description: "この推論生成に固有の識別子" },
          { name: "signature", type: "string", isOptional: true, description: "利用可能な場合の最終的な推論署名" },
          { name: "providerMetadata", type: "SharedV2ProviderMetadata", isOptional: true, description: "プロバイダ固有のメタデータ" }
        ]
      }]
    }
  ]}
/>

### reasoning-signature

高度な推論をサポートするモデル（OpenAI の o1 シリーズなど）からの推論シグネチャを含みます。シグネチャは、モデルの内部推論プロセスに関するメタデータ（労力レベルや推論アプローチなど）を表しますが、実際の推論内容自体は含みません。

<PropertiesTable
  content={[
    {
      name: "type",
      type: '"reasoning-signature"',
      description: "チャンクタイプの識別子"
    },
    {
      name: "payload",
      type: "ReasoningSignaturePayload",
      description: "モデルの推論プロセス特性に関するメタデータ",
      properties: [{
        type: "ReasoningSignaturePayload",
        parameters: [
          { name: "id", type: "string", description: "推論セッションの一意の識別子" },
          { name: "signature", type: "string", description: "推論アプローチや労力レベルを示すシグネチャ（例：推論の労力設定）" },
          { name: "providerMetadata", type: "SharedV2ProviderMetadata", isOptional: true, description: "プロバイダー固有のメタデータ" }
        ]
      }]
    }
  ]}
/>

## ツールチャンク

### tool-call

ツールが呼び出されています。

<PropertiesTable
  content={[
    {
      name: "type",
      type: '"tool-call"',
      description: "チャンクタイプの識別子"
    },
    {
      name: "payload",
      type: "ToolCallPayload",
      description: "ツール呼び出しに関する情報",
      properties: [{
        type: "ToolCallPayload",
        parameters: [
          { name: "toolCallId", type: "string", description: "このツール呼び出しの一意の識別子" },
          { name: "toolName", type: "string", description: "呼び出されているツール名" },
          { name: "args", type: "Record<string, any>", isOptional: true, description: "ツールに渡される引数" },
          { name: "providerExecuted", type: "boolean", isOptional: true, description: "プロバイダーがツールを実行したかどうか" },
          { name: "output", type: "any", isOptional: true, description: "利用可能な場合のツールの出力" },
          { name: "providerMetadata", type: "SharedV2ProviderMetadata", isOptional: true, description: "プロバイダー固有のメタデータ" }
        ]
      }]
    }
  ]}
/>

### tool-result

ツール実行の結果。

<PropertiesTable
  content={[
    {
      name: "type",
      type: '"tool-result"',
      description: "チャンク種別の識別子"
    },
    {
      name: "payload",
      type: "ToolResultPayload",
      description: "ツールの実行結果",
      properties: [{
        type: "ToolResultPayload",
        parameters: [
          { name: "toolCallId", type: "string", description: "ツール呼び出しの一意の識別子" },
          { name: "toolName", type: "string", description: "実行されたツール名" },
          { name: "result", type: "any", description: "ツール実行の結果" },
          { name: "isError", type: "boolean", isOptional: true, description: "結果がエラーかどうか" },
          { name: "providerExecuted", type: "boolean", isOptional: true, description: "プロバイダーがツールを実行したかどうか" },
          { name: "args", type: "Record<string, any>", isOptional: true, description: "ツールに渡された引数" },
          { name: "providerMetadata", type: "SharedV2ProviderMetadata", isOptional: true, description: "プロバイダー固有のメタデータ" }
        ]
      }]
    }
  ]}
/>

### tool-call-input-streaming-start

ツール呼び出し引数のストリーミング開始を通知します。

<PropertiesTable
  content={[
    {
      name: "type",
      type: '"tool-call-input-streaming-start"',
      description: "チャンク種別識別子"
    },
    {
      name: "payload",
      type: "ToolCallInputStreamingStartPayload",
      description: "ツール呼び出し入力ストリーミング開始に関する情報",
      properties: [{
        type: "ToolCallInputStreamingStartPayload",
        parameters: [
          { name: "toolCallId", type: "string", description: "このツール呼び出しの一意な識別子" },
          { name: "toolName", type: "string", description: "呼び出されるツール名" },
          { name: "providerExecuted", type: "boolean", isOptional: true, description: "プロバイダーがツールを実行したかどうか" },
          { name: "dynamic", type: "boolean", isOptional: true, description: "ツール呼び出しが動的かどうか" },
          { name: "providerMetadata", type: "SharedV2ProviderMetadata", isOptional: true, description: "プロバイダー固有のメタデータ" }
        ]
      }]
    }
  ]}
/>

### tool-call-delta

ストリーミング中に段階的に出力されるツール呼び出し引数。

<PropertiesTable
  content={[
    {
      name: "type",
      type: '"tool-call-delta"',
      description: "チャンク種別の識別子"
    },
    {
      name: "payload",
      type: "ToolCallDeltaPayload",
      description: "段階的に出力されるツール呼び出し引数",
      properties: [{
        type: "ToolCallDeltaPayload",
        parameters: [
          { name: "argsTextDelta", type: "string", description: "ツール引数に対する段階的なテキスト差分" },
          { name: "toolCallId", type: "string", description: "このツール呼び出しの一意の識別子" },
          { name: "toolName", type: "string", isOptional: true, description: "呼び出されるツール名" },
          { name: "providerMetadata", type: "SharedV2ProviderMetadata", isOptional: true, description: "プロバイダー固有のメタデータ" }
        ]
      }]
    }
  ]}
/>

### tool-call-input-streaming-end

ツール呼び出しの引数ストリーミングの終了を示します。

<PropertiesTable
  content={[
    {
      name: "type",
      type: '"tool-call-input-streaming-end"',
      description: "チャンク種別の識別子"
    },
    {
      name: "payload",
      type: "ToolCallInputStreamingEndPayload",
      description: "ツール呼び出し入力のストリーミング終了情報",
      properties: [{
        type: "ToolCallInputStreamingEndPayload",
        parameters: [
          { name: "toolCallId", type: "string", description: "このツール呼び出しの一意の識別子" },
          { name: "providerMetadata", type: "SharedV2ProviderMetadata", isOptional: true, description: "プロバイダー固有のメタデータ" }
        ]
      }]
    }
  ]}
/>

### tool-error

ツールの実行中にエラーが発生しました。

<PropertiesTable
  content={[
    {
      name: "type",
      type: '"tool-error"',
      description: "チャンク種別識別子"
    },
    {
      name: "payload",
      type: "ToolErrorPayload",
      description: "ツールエラーの情報",
      properties: [{
        type: "ToolErrorPayload",
        parameters: [
          { name: "id", type: "string", isOptional: true, description: "任意のID" },
          { name: "toolCallId", type: "string", description: "ツール呼び出しの一意なID" },
          { name: "toolName", type: "string", description: "失敗したツール名" },
          { name: "args", type: "Record<string, any>", isOptional: true, description: "ツールに渡された引数" },
          { name: "error", type: "unknown", description: "発生したエラー" },
          { name: "providerExecuted", type: "boolean", isOptional: true, description: "プロバイダがツールを実行したかどうか" },
          { name: "providerMetadata", type: "SharedV2ProviderMetadata", isOptional: true, description: "プロバイダ固有のメタデータ" }
        ]
      }]
    }
  ]}
/>

## ソースとファイルのチャンク

### source

コンテンツに関するソース情報が含まれます。

<PropertiesTable
  content={[
    {
      name: "type",
      type: '"source"',
      description: "チャンク種別の識別子"
    },
    {
      name: "payload",
      type: "SourcePayload",
      description: "ソース情報",
      properties: [{
        type: "SourcePayload",
        parameters: [
          { name: "id", type: "string", description: "一意の識別子" },
          { name: "sourceType", type: "'url' | 'document'", description: "ソースの種類" },
          { name: "title", type: "string", description: "ソースのタイトル" },
          { name: "mimeType", type: "string", isOptional: true, description: "ソースのMIME タイプ" },
          { name: "filename", type: "string", isOptional: true, description: "該当する場合のファイル名" },
          { name: "url", type: "string", isOptional: true, description: "該当する場合の URL" },
          { name: "providerMetadata", type: "SharedV2ProviderMetadata", isOptional: true, description: "プロバイダ固有のメタデータ" }
        ]
      }]
    }
  ]}
/>

### file

ファイルデータを含みます。

<PropertiesTable
  content={[
    {
      name: "type",
      type: '"file"',
      description: "チャンク種別の識別子"
    },
    {
      name: "payload",
      type: "FilePayload",
      description: "ファイルデータ",
      properties: [{
        type: "FilePayload",
        parameters: [
          { name: "data", type: "string | Uint8Array", description: "ファイルデータ本体" },
          { name: "base64", type: "string", isOptional: true, description: "該当する場合のBase64エンコード済みデータ" },
          { name: "mimeType", type: "string", description: "ファイルのMIMEタイプ" },
          { name: "providerMetadata", type: "SharedV2ProviderMetadata", isOptional: true, description: "プロバイダー固有のメタデータ" }
        ]
      }]
    }
  ]}
/>

## 制御チャンク

### 開始

ストリーミングの開始を示します。

<PropertiesTable
  content={[
    {
      name: "type",
      type: '"start"',
      description: "チャンクの種類を示す識別子"
    },
    {
      name: "payload",
      type: "StartPayload",
      description: "開始に関する情報",
      properties: [{
        type: "StartPayload",
        parameters: [
          { name: "[key: string]", type: "any", description: "追加の開始データ" }
        ]
      }]
    }
  ]}
/>

### step-start

処理ステップの開始を示します。

<PropertiesTable
  content={[
    {
      name: "type",
      type: '"step-start"',
      description: "チャンク種別の識別子"
    },
    {
      name: "payload",
      type: "StepStartPayload",
      description: "ステップ開始に関する情報",
      properties: [{
        type: "StepStartPayload",
        parameters: [
          { name: "messageId", type: "string", isOptional: true, description: "任意のメッセージ ID" },
          { name: "request", type: "object", description: "ボディなどを含むリクエスト情報" },
          { name: "warnings", type: "LanguageModelV2CallWarning[]", isOptional: true, description: "言語モデル呼び出しからの警告一覧" }
        ]
      }]
    }
  ]}
/>

### step-finish

処理ステップが完了したことを示します。

<PropertiesTable
  content={[
    {
      name: "type",
      type: '"step-finish"',
      description: "チャンクタイプの識別子"
    },
    {
      name: "payload",
      type: "StepFinishPayload",
      description: "ステップ完了に関する情報",
      properties: [{
        type: "StepFinishPayload",
        parameters: [
          { name: "id", type: "string", isOptional: true, description: "任意の識別子" },
          { name: "messageId", type: "string", isOptional: true, description: "任意のメッセージ識別子" },
          { name: "stepResult", type: "object", description: "理由・警告・継続情報を含むステップ実行結果" },
          { name: "output", type: "object", description: "使用状況統計を含む出力情報" },
          { name: "metadata", type: "object", description: "リクエストおよびプロバイダー情報を含む実行時メタデータ" },
          { name: "totalUsage", type: "LanguageModelV2Usage", isOptional: true, description: "総使用状況の統計" },
          { name: "response", type: "LanguageModelV2ResponseMetadata", isOptional: true, description: "レスポンスのメタデータ" },
          { name: "providerMetadata", type: "SharedV2ProviderMetadata", isOptional: true, description: "プロバイダー固有メタデータ" }
        ]
      }]
    }
  ]}
/>

### raw

プロバイダー提供の未加工データを含みます。

<PropertiesTable
  content={[
    {
      name: "type",
      type: '"raw"',
      description: "チャンク種別識別子"
    },
    {
      name: "payload",
      type: "RawPayload",
      description: "プロバイダーの未加工データ",
      properties: [{
        type: "RawPayload",
        parameters: [
          { name: "[key: string]", type: "any", description: "プロバイダーからの未加工データ" }
        ]
      }]
    }
  ]}
/>

### finish

ストリームは正常に完了しました。

<PropertiesTable
  content={[
    {
      name: "type",
      type: '"finish"',
      description: "チャンクタイプの識別子"
    },
    {
      name: "payload",
      type: "FinishPayload",
      description: "完了に関する情報",
      properties: [{
        type: "FinishPayload",
        parameters: [
          { name: "stepResult", type: "object", description: "ステップ実行結果" },
          { name: "output", type: "object", description: "使用量を含む出力情報" },
          { name: "metadata", type: "object", description: "実行メタデータ" },
          { name: "messages", type: "object", description: "メッセージ履歴" }
        ]
      }]
    }
  ]}
/>

### error

ストリーミング中にエラーが発生しました。

<PropertiesTable
  content={[
    {
      name: "type",
      type: '"error"',
      description: "チャンク種別を識別するID"
    },
    {
      name: "payload",
      type: "ErrorPayload",
      description: "エラー情報",
      properties: [{
        type: "ErrorPayload",
        parameters: [
          { name: "error", type: "unknown", description: "発生したエラー" }
        ]
      }]
    }
  ]}
/>

### abort

ストリームが中断されました。

<PropertiesTable
  content={[
    {
      name: "type",
      type: '"abort"',
      description: "チャンクタイプ識別子"
    },
    {
      name: "payload",
      type: "AbortPayload",
      description: "中断情報",
      properties: [{
        type: "AbortPayload",
        parameters: [
          { name: "[key: string]", type: "any", description: "追加の中断データ" }
        ]
      }]
    }
  ]}
/>

## オブジェクトと出力チャンク

### object

定義済みスキーマでの出力生成時に発行されます。指定の Zod または JSON スキーマに適合する、部分的または完全な構造化データを含みます。このチャンクは、実行コンテキストによってはスキップされることがあり、構造化オブジェクト生成のストリーミングに用いられます。

<PropertiesTable
  content={[
    {
      name: "type",
      type: '"object"',
      description: "チャンク種別の識別子"
    },
    {
      name: "object",
      type: "PartialSchemaOutput<OUTPUT>",
      description: "定義済みスキーマに適合する部分的または完全な構造化データ。型は OUTPUT スキーマパラメータによって決まります。"
    }
  ]}
/>

### tool-output

エージェントまたはワークフローの実行結果を含み、特に使用状況の統計や完了イベントの追跡に用いられます。入れ子の実行コンテキストを提供するために、他のチャンクタイプ（finish チャンクなど）をラップすることがよくあります。

<PropertiesTable
  content={[
    {
      name: "type",
      type: '"tool-output"',
      description: "チャンクタイプの識別子"
    },
    {
      name: "payload",
      type: "ToolOutputPayload",
      description: "メタデータ付きでラップされた実行出力",
      properties: [{
        type: "ToolOutputPayload",
        parameters: [
          { name: "output", type: "ChunkType", description: "入れ子のチャンクデータ。使用状況の統計を含む完了イベントを含むことがよくあります" }
        ]
      }]
    }
  ]}
/>

### step-output

ワークフローステップの実行出力を含み、主に利用状況の追跡やステップ完了イベントに使用されます。tool-output に似ていますが、個々のワークフローステップに特化しています。

<PropertiesTable
  content={[
    {
      name: "type",
      type: '"step-output"',
      description: "チャンク種別識別子"
    },
    {
      name: "payload",
      type: "StepOutputPayload",
      description: "メタデータ付きのワークフローステップ実行出力",
      properties: [{
        type: "StepOutputPayload",
        parameters: [
          { name: "output", type: "ChunkType", description: "ステップ実行からの入れ子になったチャンクデータ。通常は終了イベントやその他のステップ結果を含みます" }
        ]
      }]
    }
  ]}
/>

## メタデータと特殊チャンク

### response-metadata

LLMプロバイダーのレスポンスに関するメタデータを含みます。テキスト生成後に、一部のプロバイダーがモデルID、タイムスタンプ、レスポンスヘッダーなどの追加情報を提供するために出力します。このチャンクは内部の状態追跡に使用され、メッセージの組み立てには影響しません。

<PropertiesTable
  content={[
    {
      name: "type",
      type: '"response-metadata"',
      description: "チャンクタイプの識別子"
    },
    {
      name: "payload",
      type: "ResponseMetadataPayload",
      description: "追跡およびデバッグ用のプロバイダーのレスポンスメタデータ",
      properties: [{
        type: "ResponseMetadataPayload",
        parameters: [
          { name: "signature", type: "string", isOptional: true, description: "利用可能な場合のレスポンス署名" },
          { name: "[key: string]", type: "any", description: "プロバイダー固有の追加メタデータフィールド（例：id、modelId、timestamp、headers）" }
        ]
      }]
    }
  ]}
/>

### watch

エージェント実行に関する監視・可観測性データを含みます。`streamVNext()` の使用コンテキストに応じて、ワークフローの状態情報、実行進行状況、その他のランタイム詳細が含まれる場合があります。

<PropertiesTable
  content={[
    {
      name: "type",
      type: '"watch"',
      description: "チャンク種別の識別子"
    },
    {
      name: "payload",
      type: "WatchPayload",
      description: "エージェント実行の可観測性とデバッグのための監視データ",
      properties: [{
        type: "WatchPayload",
        parameters: [
          { name: "workflowState", type: "object", isOptional: true, description: "現在のワークフロー実行状態（ワークフローで使用される場合）" },
          { name: "eventTimestamp", type: "number", isOptional: true, description: "イベント発生時刻のタイムスタンプ" },
          { name: "[key: string]", type: "any", description: "追加の監視・実行データ" }
        ]
      }]
    }
  ]}
/>

### tripwire

出力プロセッサによりコンテンツがブロックされた結果、ストリームが強制終了された際に発行されます。これは、有害または不適切なコンテンツのストリーミングを防ぐためのセーフティ機構として機能します。

<PropertiesTable
  content={[
    {
      name: "type",
      type: '"tripwire"',
      description: "チャンク種別の識別子"
    },
    {
      name: "payload",
      type: "TripwirePayload",
      description: "セーフティ機構によってストリームが終了された理由に関する情報",
      properties: [{
        type: "TripwirePayload",
        parameters: [
          { name: "tripwireReason", type: "string", description: "コンテンツがブロックされた理由の説明（例：'Output processor blocked content'）" }
        ]
      }]
    }
  ]}
/>

## 使用例

```typescript
const stream = await agent.streamVNext("Hello");

for await (const chunk of stream.fullStream) {
  switch (chunk.type) {
    case 'text-delta':
      console.log('テキスト:', chunk.payload.text);
      break;

    case 'tool-call':
      console.log('ツール呼び出し:', chunk.payload.toolName);
      break;

    case 'tool-result':
      console.log('ツール結果:', chunk.payload.result);
      break;

    case 'reasoning-delta':
      console.log('推論:', chunk.payload.text);
      break;

    case 'finish':
      console.log('完了:', chunk.payload.stepResult.reason);
      console.log('使用量:', chunk.payload.output.usage);
      break;

    case 'error':
      console.error('エラー:', chunk.payload.error);
      break;
  }
}
```

## 関連する型

- [MastraModelOutput](./MastraModelOutput.mdx) - これらのチャンクを生成して流すストリームオブジェクト
- [.streamVNext()](./streamVNext.mdx) - これらのチャンクを流すストリームを返すメソッド