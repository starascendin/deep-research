---
title: "mastra build | 本番用バンドル | Mastra CLI"
description: "Mastra プロジェクトを本番環境にデプロイできるようビルドする"
---



# mastra build

`mastra build` コマンドは、Mastra プロジェクトを本番運用可能な Hono サーバーとしてバンドルします。Hono は、ミドルウェア対応の HTTP エンドポイントとして Mastra エージェントを簡単にデプロイできる、軽量で型安全な Web フレームワークです。



## 使い方

```bash
mastra build [options]
```



## オプション

<PropertiesTable
  content={[
    {
      name: "--dir",
      type: "string",
      description: "Mastra フォルダへのパス",
      isOptional: true,
    },
    {
      name: "--root",
      type: "string",
      description: "ルートフォルダへのパス",
      isOptional: true,
    },
    {
      name: "--tools",
      type: "string",
      description: "含めるツールファイルのパスをカンマ区切りで指定したリスト",
      isOptional: true,
    },
    {
      name: "--help",
      type: "boolean",
      description: "コマンドのヘルプを表示する",
      isOptional: true,
    },
  ]}
/>



## 上級者向けの使い方

### 並列実行の制限

CI やリソースが限られた環境で実行する場合は、`MASTRA_CONCURRENCY` を設定して、同時に実行する高コストなタスクの数を上限化できます。

```bash copy
MASTRA_CONCURRENCY=2 mastra build
```

未設定にすると、CLI がホストの性能に基づいて並列度を決定します。

### テレメトリーの無効化

匿名のビルド分析をオプトアウトするには、次を設定します:

```bash copy
MASTRA_TELEMETRY_DISABLED=1 mastra build
```

### カスタムプロバイダーエンドポイント

ビルド時は `OPENAI_BASE_URL` と `ANTHROPIC_BASE_URL` の各変数が `mastra dev` と同様に有効です。これらは AI SDK によって、プロバイダーを呼び出すワークフローやツールへ転送されます。



## 何をするか

1. Mastra のエントリーファイル（`src/mastra/index.ts` または `src/mastra/index.js`）を検出します
2. `.mastra` 出力ディレクトリを作成します
3. 以下の設定で Rollup を使ってコードをバンドルします:
   - バンドルサイズ最適化のためのツリーシェイキング
   - Node.js 環境をターゲット
   - デバッグ用のソースマップ生成
   - テストファイル（名前に `.test.` または `.spec.` を含むもの、または `__tests__` ディレクトリ内）を除外



## 例

```bash copy
# 現在のディレクトリからビルド
mastra build

# 指定したディレクトリからビルド
mastra build --dir ./my-mastra-project
```



## 出力

このコマンドは、`.mastra` ディレクトリに本番用バンドルを生成します。内容は次のとおりです:

- Mastra エージェントをエンドポイントとして公開する、Hono ベースの HTTP サーバー
- 本番環境向けに最適化されたバンドル済み JavaScript ファイル
- デバッグ用ソースマップ
- 必要な依存関係

この出力は次の用途に適しています:

- クラウドサーバー（EC2、DigitalOcean）へのデプロイ
- コンテナ化環境での実行
- コンテナオーケストレーションシステムでの利用



## デプロイヤー

Deployer を使用すると、ビルド出力は対象プラットフォーム向けに自動的に最適化・準備されます。例：

- [Vercel Deployer](/reference/deployer/vercel)
- [Netlify Deployer](/reference/deployer/netlify)
- [Cloudflare Deployer](/reference/deployer/cloudflare)
