---
title: "Mastra のインストール | はじめに | Mastra ドキュメント"
description: さまざまな LLM プロバイダーでの実行に必要な前提条件のセットアップと、Mastra のインストール方法を解説します。
---

import { Callout, Steps } from "nextra/components";
import { Tabs, Tab } from "@/components/tabs";


# Mastra をインストール

Mastra を使い始めるには、大規模言語モデル（LLM）へのアクセスが必要です。既定では Mastra は [OpenAI](https://platform.openai.com/) と連携するように設定されているため、利用を開始するには API キーが必要です。

Mastra は他の LLM プロバイダーにも対応しています。対応モデルの一覧とセットアップ手順は、[Model Providers](/docs/getting-started/model-providers) を参照してください。

## 前提条件

- Node.js `v20.0` 以上
- サポート対象の[モデルプロバイダー](/docs/getting-started/model-providers)の API キー

## `create mastra` CLI でインストールする

CLI は Mastra を始める最速の方法です。`create mastra` はマシン上のどこからでも実行できます。

<Callout type="warning">
  現在の CLI は `ai-sdk v4` にのみ対応したプロジェクトを生成します。`ai-sdk v5` を使用する場合は、[ai-sdk v5 compatibility](#ai-sdk-v5-compatibility) を参照してください。
</Callout>

<Steps>

## CLI ウィザードを開始する

対話型セットアップを開始するには、次のコマンドを実行します：

{/*
LLM CONTEXT: This Tabs component shows different package manager commands for creating a new Mastra project.
Each tab displays the equivalent command for that specific package manager (npx, npm, yarn, pnpm, bun).
This helps users choose their preferred package manager while following the same installation process.
All commands achieve the same result - creating a new Mastra project with the interactive setup.
*/}

<Tabs items={["npm", "yarn", "pnpm", "bun"]}>
  <Tab>
    ```bash copy
    npx create-mastra@latest
    ```
  </Tab>
  <Tab>
    ```bash copy
    yarn dlx create-mastra@latest
    ```
  </Tab>
  <Tab>
    ```bash copy
    pnpm create mastra@latest
    ```
  </Tab>
  <Tab>
    ```bash copy
    bun create mastra@latest
    ```
  </Tab>
</Tabs>


**CLI フラグでインストールする**

必要なフラグをすべて渡すことで、Mastra CLI を非対話モードでも実行できます。例：

```bash copy
npx create-mastra@latest --project-name hello-mastra --example --components tools,agents,workflows --llm openai
```

**テンプレートでインストールする**

特定のユースケースを示すプリセットのテンプレートから始められます：

```bash copy
npx create-mastra@latest --template template-name
```

> 利用可能なテンプレートの一覧や詳細は [Templates](/docs/getting-started/templates) を参照してください。

たとえば、text-to-SQL アプリケーションを作成するには：

```bash copy
npx create-mastra@latest --template text-to-sql
```

> 利用可能な CLI オプションの一覧は [create-mastra](/reference/cli/create-mastra) のドキュメントを参照してください。

### API キーを追加する

`.env` ファイルに API キーを追加します：

```bash filename=".env" copy
OPENAI_API_KEY=<your-api-key>
```
> この例では OpenAI を使用しています。各 LLM プロバイダーで使用する環境変数名は異なります。詳細は [Model Capabilities](/docs/getting-started/model-capability) を参照してください。

### Mastra Development Server を起動する

[Mastra Development Server](/docs/server-db/local-dev-playground) を起動し、Mastra Playground でエージェントをテストできます。

{/*
LLM CONTEXT: This Tabs component shows different package manager commands for starting Mastra's development server.
Each tab displays the equivalent command for that specific package manager (npx, npm, yarn, pnpm, bun).
This helps users choose their preferred package manager.
All commands achieve the same result - starting Mastra's development server.
*/}

<Tabs items={["npm", "yarn", "pnpm", "bun", "Mastra CLI"]}>
  <Tab>
    ```bash copy
    npm run dev
    ```
  </Tab>
  <Tab>
    ```bash copy
    yarn run dev
    ```
  </Tab>
  <Tab>
    ```bash copy
    pnpm run dev
    ```
  </Tab>
  <Tab>
    ```bash copy
    bun run dev
    ```
  </Tab>
  <Tab>
    ```bash copy
    mastra dev
    ```
  </Tab>
</Tabs>

</Steps>

## 手動でインストールする

以下の手順では、Mastra を手動でインストールする方法を順を追って説明します。

<Steps>
  ### 新規プロジェクトを作成

  新規プロジェクトを作成し、ディレクトリへ移動します：

  ```bash copy
  mkdir hello-mastra && cd hello-mastra
  ```

  `@mastra/core` パッケージを含む TypeScript プロジェクトを初期化する:

  {/*
    LLM コンテキスト: この Tabs コンポーネントは、パッケージマネージャーごとの手動インストールコマンドを表示します。
    各タブには、そのパッケージマネージャーにおけるプロジェクトの初期化、
    開発用依存関係のインストール、そして Mastra のコアパッケージのインストールまで、セットアップ手順が一通り表示されます。
    これにより、ユーザーは好みのパッケージマネージャーで Mastra プロジェクトを手動でセットアップできます。
    */}

  <Tabs items={["npm", "pnpm", "yarn", "bun"]}>
    <Tab>
      ```bash copy
      npm init -y

      npm install typescript tsx @types/node mastra@latest --save-dev

      npm install @mastra/core@latest zod@^3 @ai-sdk/openai@^1
      ```
    </Tab>

    <Tab>
      ```bash copy
      pnpm init

      pnpm add typescript tsx @types/node mastra@latest --save-dev

      pnpm add @mastra/core@latest zod@^3 @ai-sdk/openai@^1
      ```
    </Tab>

    <Tab>
      ```bash copy
      yarn init -y

      yarn add typescript tsx @types/node mastra@latest --dev

      yarn add @mastra/core@latest zod@^3 @ai-sdk/openai@^1
      ```
    </Tab>

    <Tab>
      ```bash copy
      bun init -y

      bun add typescript tsx @types/node mastra@latest --dev

      bun add @mastra/core@latest zod@^3 @ai-sdk/openai@^1
      ```
    </Tab>
  </Tabs>

  `package.json` に `dev` と `build` のスクリプトを追加します：

  ```json filename="package.json" copy
  {
    "scripts": {
      // ...
      "dev": "mastra dev",
      "build": "mastra build"
    }
  }
  ```

  ### TypeScript の初期化

  `tsconfig.json` ファイルを作成する：

  ```bash copy
  touch tsconfig.json
  ```

  次の設定を追加する：

  Mastra では、最新の Node.js バージョンに対応した `module` と `moduleResolution` の設定値が必要です。`CommonJS` や `node` といった古い設定は Mastra のパッケージと互換性がなく、モジュール解決エラーの原因になります。

  ```json {4-5} filename="tsconfig.json" copy
  {
    "compilerOptions": {
      "target": "ES2022",
      "module": "ES2022",
      "moduleResolution": "bundler",
      "esModuleInterop": true,
      "forceConsistentCasingInFileNames": true,
      "strict": true,
      "skipLibCheck": true,
      "noEmit": true,
      "outDir": "dist"
    },
    "include": [
      "src/**/*"
    ]
  }
  ```

  > この TypeScript 設定は、最新のモジュール解決と厳格な型チェックを採用し、Mastra プロジェクト向けに最適化されています。

  ### APIキーを設定

  `.env` ファイルを作成する：

  ```bash copy
  touch .env
  ```

  API キーを追加：

  ```bash filename=".env" copy
  OPENAI_API_KEY=<あなたのAPIキー>
  ```

  > この例では OpenAI を使用します。LLM プロバイダーごとにモデル名は異なります。詳細は [Model Capabilities](/docs/getting-started/model-capability) を参照してください。

  ### ツールを作成

  「weather-tool.ts」ファイルを作成する：

  ```bash copy
  mkdir -p src/mastra/tools && touch src/mastra/tools/weather-tool.ts
  ```

  次のコードを追加してください：

  ```ts filename="src/mastra/tools/weather-tool.ts" showLineNumbers copy
  import { createTool } from "@mastra/core/tools";
  import { z } from "zod";

  export const weatherTool = createTool({
    id: "get-weather",
    description: "指定した場所の現在の天気を取得する"
    inputSchema: z.object({
      location: z.string().describe("都市名")
    }),
    outputSchema: z.object({
      output: z.string()
    }),
    execute: async () => {
      return {
        output: "天気は晴れです"
      };
    }
  });
  ```

  > weatherTool の完全な例は、[Giving an Agent a Tool](/examples/agents/using-a-tool)をご覧ください。

  ### エージェントを作成

  「weather-agent.ts」ファイルを作成する：

  ```bash copy
  mkdir -p src/mastra/agents && touch src/mastra/agents/weather-agent.ts
  ```

  次のコードを追加してください：

  ```ts filename="src/mastra/agents/weather-agent.ts" showLineNumbers copy
  import { openai } from "@ai-sdk/openai";
  import { Agent } from "@mastra/core/agent";
  import { weatherTool } from "../tools/weather-tool";

  export const weatherAgent = new Agent({
    name: 'Weather Agent',
    instructions: `
        あなたは正確な気象情報を提供する、役に立つ天気アシスタントです。

        主な役割は、ユーザーが特定の場所の天気情報を取得できるよう支援することです。応答時は次を守ってください:
        - 場所が指定されていない場合は、必ず場所を確認する
        - 場所名が英語でない場合は、英語に翻訳する
        - 複数の要素を含む場所（例: "New York, NY"）が指定された場合は、最も関連性の高い部分（例: "New York"）を用いる
        - 湿度、風況、降水などの関連情報を含める
        - 簡潔でありながら有用な回答を心がける

        現在の天気データを取得するには、weatherTool を使用する。
  `,
    model: openai('gpt-4o-mini'),
    tools: { weatherTool }
  });
  ```

  ### エージェントを登録

  Mastra のエントリポイントを作成し、エージェントを登録する：

  ```bash copy
  touch src/mastra/index.ts
  ```

  次のコードを追加してください：

  ```ts filename="src/mastra/index.ts" showLineNumbers copy
  import { Mastra } from "@mastra/core/mastra";
  import { weatherAgent } from "./agents/weather-agent";

  export const mastra = new Mastra({
    agents: { weatherAgent }
  });
  ```

  [Mastra Development Server](/docs/server-db/local-dev-playground) を起動し、Mastra Playground でエージェントをテストできるようになりました。
</Steps>

## 既存のプロジェクトに追加する

Mastra は幅広いプロジェクトにインストールして統合できます。以下は、導入の手助けとなる統合ガイドへのリンクです：

- [Next.js](/docs/frameworks/web-frameworks/next-js)
- [Vite + React](/docs/frameworks/web-frameworks/vite-react)
- [Astro](/docs/frameworks/web-frameworks/astro)
- [Express](/docs/frameworks/servers/express)

### `mastra init`

既存のプロジェクトに Mastra を導入するには、`mastra init` コマンドを使用します。

> 詳細は [mastra init](/reference/cli/init) を参照してください。

## ai-sdk v5 互換性

デフォルトでは、Mastra プロジェクトは `ai-sdk v4` のみに対応しています。`ai-sdk v5` を使用する場合は、生成されたプロジェクトに対して以下の変更を行ってください。

`@ai-sdk/openai` パッケージの最新バージョンをインストールします:

<Tabs items={["npm", "pnpm", "yarn", "bun"]}>

  <Tab>
    ```bash copy
    npm install @ai-sdk/openai@latest
    ```

  </Tab>
  <Tab>
    ```bash copy
    pnpm add @ai-sdk/openai@latest
    ```

  </Tab>
  <Tab>
    ```bash copy
    yarn add @ai-sdk/openai@latest
    ```

  </Tab>
  <Tab>
    ```bash copy
    bun add @ai-sdk/openai@latest
    ```

  </Tab>
</Tabs>

`src/mastra/workflows/weather-workflow.ts` の `planActivities` ステップを次のように更新します:

```ts filename="src/mastra/workflows/weather-workflow.ts" showLineNumbers{150} copy
const response = await agent.stream([ // [!code --]
const response = await agent.streamVNext([ // [!code ++]
  {
    role: 'user',
    content: prompt,
  },
]);
```

## 次のステップ

- [ローカルでの開発](/docs/server-db/local-dev-playground)
- [Mastra Cloud へのデプロイ](/docs/deployment/overview)