---
title: "ä¾‹: ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’ä½¿ã£ãŸãƒ¯ãƒ¼ã‚­ãƒ³ã‚°ãƒ¡ãƒ¢ãƒª | ãƒ¡ãƒ¢ãƒªãƒ¼ | Mastra Docs"
description: Markdownãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã§ãƒ¯ãƒ¼ã‚­ãƒ³ã‚°ãƒ¡ãƒ¢ãƒªã®ãƒ‡ãƒ¼ã‚¿ã‚’æ§‹é€ åŒ–ã™ã‚‹æ–¹æ³•ã‚’ç¤ºã™ä¾‹ã€‚
---



# ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’ç”¨ã„ãŸãƒ¯ãƒ¼ã‚­ãƒ³ã‚°ãƒ¡ãƒ¢ãƒª

ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’ä½¿ç”¨ã—ã¦ã€ãƒ¯ãƒ¼ã‚­ãƒ³ã‚°ãƒ¡ãƒ¢ãƒªã«ä¿å­˜ã™ã‚‹æƒ…å ±ã®æ§‹é€ ã‚’å®šç¾©ã—ã¾ã™ã€‚ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã¯ã€ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆãŒä¼šè©±å…¨ä½“ã‚’é€šã˜ã¦ä¸€è²«ã—ãŸæ§‹é€ åŒ–ãƒ‡ãƒ¼ã‚¿ã‚’æŠ½å‡ºãƒ»ä¿æŒã™ã‚‹ã®ã«å½¹ç«‹ã¡ã¾ã™ã€‚

ã“ã‚Œã¯ã€`.stream()` ã‚’ä½¿ã£ãŸã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°å¿œç­”ã¨ `.generate()` ã‚’ä½¿ã£ãŸç”Ÿæˆå¿œç­”ã®ä¸¡æ–¹ã§æ©Ÿèƒ½ã—ã€ã‚»ãƒƒã‚·ãƒ§ãƒ³é–“ã§ãƒ‡ãƒ¼ã‚¿ã‚’ä¿æŒã™ã‚‹ãŸã‚ã« PostgreSQLã€LibSQLã€Redis ãªã©ã®ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ãŒå¿…è¦ã§ã™ã€‚

ã“ã®ä¾‹ã§ã¯ã€ãƒ¯ãƒ¼ã‚­ãƒ³ã‚°ãƒ¡ãƒ¢ãƒªã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’ä½¿ã£ã¦ã€ToDo ãƒªã‚¹ãƒˆã‚’ç®¡ç†ã™ã‚‹æ–¹æ³•ã‚’ç¤ºã—ã¾ã™ã€‚



## å‰ææ¡ä»¶

ã“ã®ä¾‹ã§ã¯ `openai` ãƒ¢ãƒ‡ãƒ«ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚`OPENAI_API_KEY` ã‚’ `.env` ãƒ•ã‚¡ã‚¤ãƒ«ã«è¿½åŠ ã—ã¦ãã ã•ã„ã€‚

```bash filename=".env" copy
OPENAI_API_KEY=<your-api-key>
```

ã•ã‚‰ã«ã€æ¬¡ã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦ãã ã•ã„:

```bash copy
npm install @mastra/libsql
```



## ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã«ãƒ¡ãƒ¢ãƒªã‚’è¿½åŠ ã™ã‚‹

ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã« LibSQL ã®ãƒ¡ãƒ¢ãƒªã‚’è¿½åŠ ã™ã‚‹ã«ã¯ã€`Memory` ã‚¯ãƒ©ã‚¹ã‚’ä½¿ç”¨ã—ã€`LibSQLStore` ã‚’ç”¨ã„ã¦ `storage` ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’æ¸¡ã—ã¾ã™ã€‚`url` ã¯ãƒªãƒ¢ãƒ¼ãƒˆã®å ´æ‰€ã¾ãŸã¯ãƒ­ãƒ¼ã‚«ãƒ«ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æŒ‡ã›ã¾ã™ã€‚

### `template` ã‚’ä½¿ã£ãŸãƒ¯ãƒ¼ã‚­ãƒ³ã‚°ãƒ¡ãƒ¢ãƒª

`workingMemory.enabled` ã‚’ `true` ã«è¨­å®šã—ã¦ãƒ¯ãƒ¼ã‚­ãƒ³ã‚°ãƒ¡ãƒ¢ãƒªã‚’æœ‰åŠ¹åŒ–ã—ã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã¯å¯¾è©±é–“ã§æ§‹é€ åŒ–æƒ…å ±ã‚’è¨˜æ†¶ã§ãã¾ã™ã€‚

`template` ã‚’æŒ‡å®šã™ã‚‹ã¨ã€è¨˜æ†¶ã™ã¹ãå†…å®¹ã®æ§‹é€ ã‚’å®šç¾©ã§ãã¾ã™ã€‚ã“ã®ä¾‹ã§ã¯ã€ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆãŒã‚¿ã‚¹ã‚¯ã‚’ Markdown å½¢å¼ã§ã‚¢ã‚¯ãƒ†ã‚£ãƒ–é …ç›®ã¨å®Œäº†é …ç›®ã«æ•´ç†ã—ã¾ã™ã€‚

ã‚¹ãƒ¬ãƒƒãƒ‰ã¯é–¢é€£ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ä¼šè©±ã”ã¨ã«ã¾ã¨ã‚ã¾ã™ã€‚`generateTitle` ã‚’æœ‰åŠ¹ã«ã™ã‚‹ã¨ã€å„ã‚¹ãƒ¬ãƒƒãƒ‰ã«ã¯å†…å®¹ã«åŸºã¥ã„ãŸèª¬æ˜çš„ãªåå‰ãŒè‡ªå‹•çš„ã«ä»˜ä¸ã•ã‚Œã¾ã™ã€‚

```typescript filename="src/mastra/agents/example-working-memory-template-agent.ts" showLineNumbers copy
import { Memory } from "@mastra/memory";
import { Agent } from "@mastra/core/agent";
import { openai } from "@ai-sdk/openai";
import { LibSQLStore } from "@mastra/libsql";

export const workingMemoryTemplateAgent = new Agent({
  name: "working-memory-template-agent",
  instructions: `
    You are a todo list AI agent.
    Always show the current list when starting a conversation.
    For each task, include: title with index number, due date, description, status, and estimated time.
    Use emojis for each field.
    Support subtasks with bullet points.
    Ask for time estimates to help with timeboxing.
  `,
  model: openai("gpt-4o"),
  memory: new Memory({
    storage: new LibSQLStore({
      url: "file:working-memory-template.db"
    }),
    options: {
      workingMemory: {
        enabled: true,
        template: `
          # Todo List
          ## Active Items
          - Task 1: Example task
            - Due: Feb 7 2028
            - Description: This is an example task
            - Status: Not Started
            - Estimated Time: 2 hours

          ## Completed Items
          - None yet`
      },
      threads: {
        generateTitle: true
      }
    }
  })
});
```



## ä½¿ç”¨ä¾‹

ã“ã®ä¾‹ã§ã¯ã€æ§‹é€ åŒ–æƒ…å ±ã‚’ç®¡ç†ã™ã‚‹ãŸã‚ã®ãƒ¯ãƒ¼ã‚­ãƒ³ã‚°ãƒ¡ãƒ¢ãƒªãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’ç”¨ã„ã‚‹ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã¨ã®ã‚„ã‚Šå–ã‚Šæ–¹æ³•ã‚’ç¤ºã—ã¾ã™ã€‚ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã¯åŒä¸€ã‚¹ãƒ¬ãƒƒãƒ‰å†…ã®è¤‡æ•°å›ã®ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ã‚·ãƒ§ãƒ³ã«ã‚ãŸã‚Šã€todoãƒªã‚¹ãƒˆã‚’æ›´æ–°ã—ã¦ä¿æŒã—ã¾ã™ã€‚

### `.stream()` ã‚’ä½¿ã£ã¦ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°ã™ã‚‹

ã“ã®ä¾‹ã§ã¯ã€æ–°ã—ã„ã‚¿ã‚¹ã‚¯ã‚’å«ã‚€ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã«é€ä¿¡ã—ã¾ã™ã€‚ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã¯ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°ã•ã‚Œã€æ›´æ–°å¾Œã®todoãƒªã‚¹ãƒˆãŒå«ã¾ã‚Œã¾ã™ã€‚

```typescript filename="src/test-working-memory-template-agent.ts" showLineNumbers copy
import "dotenv/config";

import { mastra } from "./mastra";

const threadId = "123";
const resourceId = "user-456";

const agent = mastra.getAgent("workingMemoryTemplateAgent");

const stream = await agent.stream("Add a task: Build a new feature for our app. It should take about 2 hours and needs to be done by next Friday.", {
  memory: {
    thread: threadId,
    resource: resourceId
  }
});

for await (const chunk of stream.textStream) {
  process.stdout.write(chunk);
}
```

### `.generate()` ã‚’ä½¿ã£ã¦ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’ç”Ÿæˆã™ã‚‹

ã“ã®ä¾‹ã§ã¯ã€æ–°ã—ã„ã‚¿ã‚¹ã‚¯ã‚’å«ã‚€ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã«é€ä¿¡ã—ã¾ã™ã€‚ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã¯å˜ä¸€ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã¨ã—ã¦è¿”ã•ã‚Œã€æ›´æ–°å¾Œã®todoãƒªã‚¹ãƒˆãŒå«ã¾ã‚Œã¾ã™ã€‚

```typescript filename="src/test-working-memory-template-agent.ts" showLineNumbers copy
import "dotenv/config";

import { mastra } from "./mastra";

const threadId = "123";
const resourceId = "user-456";

const agent = mastra.getAgent("workingMemoryTemplateAgent");

const response = await agent.generate("Add a task: Build a new feature for our app. It should take about 2 hours and needs to be done by next Friday.", {
  memory: {
    thread: threadId,
    resource: resourceId
  }
});

console.log(response.text);
```



## å‡ºåŠ›ä¾‹

ã“ã®å‡ºåŠ›ã¯ã€ä½œæ¥­ãƒ¡ãƒ¢ãƒªã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã§å®šç¾©ã•ã‚ŒãŸæ§‹é€ ã«å¾“ã£ã¦ã€ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆãŒæ›´æ–°ã•ã‚ŒãŸToDoãƒªã‚¹ãƒˆã‚’æ•´å½¢ã—ã¦è¿”ã™æ–¹æ³•ã‚’ç¤ºã—ã¦ã„ã¾ã™ã€‚

```text
# ToDoãƒªã‚¹ãƒˆ
## é€²è¡Œä¸­ã®é …ç›®
1. ğŸ› ï¸ **ã‚¿ã‚¹ã‚¯:** ã‚¢ãƒ—ãƒªã«æ–°æ©Ÿèƒ½ã‚’å®Ÿè£…ã™ã‚‹
   - ğŸ“… **æœŸé™:** æ¥é€±ã®é‡‘æ›œæ—¥
   - ğŸ“ **èª¬æ˜:** æ—¢å­˜ã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«æ–°æ©Ÿèƒ½ã‚’é–‹ç™ºãƒ»çµ±åˆã™ã‚‹ã€‚
   - â³ **ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹:** æœªç€æ‰‹
   - â²ï¸ **è¦‹ç©ã‚‚ã‚Šæ™‚é–“:** 2æ™‚é–“

## å®Œäº†ã—ãŸé …ç›®
- ã¾ã ã‚ã‚Šã¾ã›ã‚“
```



## ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ä¾‹

Working memory ã¯ãƒ‡ãƒ¼ã‚¿ã‚’ `.json` å½¢å¼ã§ä¿å­˜ã—ã¾ã™ã€‚ä»¥ä¸‹ã®ã‚ˆã†ã«ãªã‚Šã¾ã™:

```json
{
  // ...
  "toolInvocations": [
    {
      // ...
      "args": {
        "memory": "# Todo List\n## Active Items\n- Task 1: Build a new feature for our app\n  - Due: Next Friday\n  - Description: Build a new feature for our app\n  - Status: Not Started\n  - Estimated Time: 2 hours\n\n## Completed Items\n- None yet"
      },
    }
  ],
}
```



## é–¢é€£é …ç›®

- [ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®å‘¼ã³å‡ºã—](../agents/calling-agents.mdx#from-the-command-line)
- [ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®ãƒ¡ãƒ¢ãƒª](../../docs/agents/agent-memory.mdx)
- [ã‚µãƒ¼ãƒãƒ¼ãƒ¬ã‚¹ã®ãƒ‡ãƒ—ãƒ­ã‚¤](../../docs/deployment/server-deployment.mdx#libsqlstore)
